"use strict";(self.webpackChunkpfefront=self.webpackChunkpfefront||[]).push([[804],{92559:(e,t,r)=>{r.d(t,{A:()=>M});var a=r(89379),s=r(65043),n=r(34535),i=r(12299),c=r(24836),o=r(56258),l=r(7353),d=r(81637),u=r(19252),p=r(61596),j=r(76839),m=r(25078),A=r(50186),h=r(14194),x=r(68903),g=r(67784),f=r(53193),y=r(79190),b=r(69285),v=r(32143),D=r(18483),P=r(42518),C=r(40794),S=r(73216),I=r(99012),N=r(71330),E=r(11046),L=r(20916),w=r(94167),k=r(80638),q=r(70579);const T=(0,n.Ay)(i.A)((e=>{let{theme:t}=e;return{"& .MuiStepLabel-label":{color:t.palette.text.secondary,"&.Mui-active":{color:t.palette.primary.main,fontWeight:600},"&.Mui-completed":{color:t.palette.success.main}}}})),B=e=>{let{in:t,direction:r="left",children:a}=e;return(0,q.jsx)(c.A,{direction:r,in:t,mountOnEnter:!0,unmountOnExit:!0,children:(0,q.jsx)(o.A,{in:t,children:(0,q.jsx)("div",{children:a})})})},W=["Basic Information","Team & Leadership","Timeline & Budget"],M=(0,s.forwardRef)(((e,t)=>{let{isEdit:r=!1,projectData:n=null,onSubmit:i,onAiClick:c,initialProjectType:M}=e;const[_,F]=(0,s.useState)({projectName:"",projectDescription:"",projectType:M||"",projectKey:"",startDate:"",endDate:"",projectLead:"",createdBy:localStorage.getItem("userId"),teams:[],budget:"",costEstimate:""}),[K,R]=(0,s.useState)(!1),[H,O]=(0,s.useState)([]),[U,$]=(0,s.useState)([]),[z,G]=(0,s.useState)(""),[Y,Z]=(0,s.useState)(""),[J,Q]=(0,s.useState)(!0),[V,X]=(0,s.useState)(0),ee=(0,S.Zp)(),{projectId:te}=(0,S.g)(),re=localStorage.getItem("userId");(0,s.useEffect)((()=>{(async()=>{try{const[e,t]=await Promise.all([I.A.getAll(),N.A.getAll()]);if(O(e.data),$(t.data),r&&te&&J){const r=(await E.A.getProject(te)).data,s=t.data.find((e=>e._id===r.projectLead)),n=r.teams.map((t=>{const r=e.data.find((e=>e._id===t));return r?r._id:null})).filter((e=>null!==e));F((0,a.A)((0,a.A)({},r),{},{projectLead:s?s._id:"",teams:n})),Q(!1)}}catch(z){console.error("Error fetching data:",z),G("Failed to load required data")}})()}),[te,r,J]),(0,s.useImperativeHandle)(t,(()=>({updateFormData:e=>{F((t=>(0,a.A)((0,a.A)({},t),e)))}})));const ae=e=>{const{name:t,value:r}=e.target;F((e=>{const s=(0,a.A)((0,a.A)({},e),{},{[t]:r});return("projectName"===t||"startDate"===t)&&s.projectName&&s.startDate&&(s.projectKey=((e,t)=>{if(!e||!t)return"";const r=e.substring(0,2).toUpperCase(),a=new Date(t),s=(a.getMonth()+1).toString().padStart(2,"0"),n=a.getFullYear().toString().slice(2);return"".concat(r).concat(s).concat(n)})(s.projectName,s.startDate)),s}))},se=()=>{if(0===V){if(!_.projectName.trim())return"Project Name is required";if(!_.projectDescription.trim())return"Project Description is required";if(!_.projectType.trim())return"Project Type is required"}else if(1===V){if(!_.projectLead)return"Project Lead is required"}else if(2===V){if(!_.startDate)return"Start Date is required";if(!_.endDate)return"End Date is required";if(new Date(_.endDate)<=new Date(_.startDate))return"End Date must be after Start Date";if(_.budget&&isNaN(Number(_.budget)))return"Budget must be a valid number";if(_.costEstimate&&isNaN(Number(_.costEstimate)))return"Cost Estimate must be a valid number"}return null},ne=()=>{const e=se();e?G(e):V<2&&X(V+1)},ie=async e=>{e.preventDefault(),R(!0),G(""),Z("");const t=se();if(t)return G(t),void R(!1);if(2===V)try{const e=(0,a.A)((0,a.A)({},_),{},{createdBy:re});i&&(await i(te,e),Z(r?"Project updated successfully!":"Project created successfully!"),setTimeout((()=>ee("/projects")),2e3))}catch(z){console.error("Failed to submit project",z);let t="Failed to submit project. Please try again.";t=z.response?z.response.data.message||t:z.request?"No response received from server. Please check your connection.":z.message||t,G(t)}finally{R(!1)}else ne()};return K&&!J?(0,q.jsx)(l.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",children:(0,q.jsx)(d.A,{})}):(0,q.jsx)(l.A,{sx:{width:"100%",mb:4},children:(0,q.jsxs)(u.A,{component:"main",maxWidth:"md",children:[(0,q.jsxs)(p.A,{elevation:6,sx:{p:{xs:2,sm:4},mt:3,borderRadius:2,position:"relative",overflow:"hidden"},children:[(0,q.jsx)(j.A,{activeStep:V,alternativeLabel:!0,nonLinear:!0,sx:{mb:4,"& .MuiStepConnector-line":{borderColor:"rgba(0, 0, 0, 0.12)"}},children:W.map(((e,t)=>(0,q.jsx)(m.A,{completed:t<V,children:(0,q.jsx)(A.A,{onClick:()=>(e=>{const t=se();!t||e<V?(X(e),G("")):G(t)})(t),children:(0,q.jsx)(T,{children:e})})},e)))}),z&&(0,q.jsx)(o.A,{in:!!z,children:(0,q.jsx)(h.A,{severity:"error",sx:{mb:3},onClose:()=>G(""),children:z})}),(0,q.jsxs)(l.A,{component:"form",onSubmit:ie,children:[(0,q.jsx)(B,{in:0===V,direction:"left",children:(0,q.jsxs)(x.Ay,{container:!0,spacing:3,sx:{display:0===V?"flex":"none"},children:[(0,q.jsx)(x.Ay,{item:!0,xs:12,children:(0,q.jsx)(g.A,{required:!0,fullWidth:!0,id:"projectName",name:"projectName",label:"Project Name",value:_.projectName,onChange:ae,autoFocus:!0})}),(0,q.jsx)(x.Ay,{item:!0,xs:12,children:(0,q.jsx)(g.A,{required:!0,fullWidth:!0,multiline:!0,rows:4,id:"projectDescription",name:"projectDescription",label:"Project Description",value:_.projectDescription,onChange:ae})}),(0,q.jsx)(x.Ay,{item:!0,xs:12,children:(0,q.jsx)(g.A,{fullWidth:!0,id:"projectKey",name:"projectKey",label:"Project Key",value:_.projectKey,disabled:!0,helperText:"Auto-generated from Project Name and Start Date"})})]})}),(0,q.jsx)(B,{in:1===V,direction:V>1?"left":"right",children:(0,q.jsxs)(x.Ay,{container:!0,spacing:3,sx:{display:1===V?"flex":"none"},children:[(0,q.jsx)(x.Ay,{item:!0,xs:12,children:(0,q.jsxs)(f.A,{fullWidth:!0,children:[(0,q.jsx)(y.A,{id:"project-lead-label",children:"Project Lead *"}),(0,q.jsx)(b.A,{labelId:"project-lead-label",id:"projectLead",name:"projectLead",value:_.projectLead,onChange:ae,required:!0,label:"Project Lead",children:U.map((e=>(0,q.jsx)(v.A,{value:e._id,children:e.email},e._id)))})]})}),(0,q.jsx)(x.Ay,{item:!0,xs:12,children:(0,q.jsxs)(f.A,{fullWidth:!0,children:[(0,q.jsx)(y.A,{id:"teams-label",children:"Teams"}),(0,q.jsx)(b.A,{labelId:"teams-label",id:"teams",name:"teams",multiple:!0,value:_.teams,onChange:e=>{const{value:t}=e.target;F((e=>(0,a.A)((0,a.A)({},e),{},{teams:t})))},label:"Teams",children:H.map((e=>{const t=e.members.map((e=>U.find((t=>t._id===e)))).filter((e=>e)).map((e=>e.email)).join(", ");return(0,q.jsx)(v.A,{value:e._id,children:(0,q.jsx)(D.A,{title:"Members: ".concat(t),arrow:!0,placement:"right",children:(0,q.jsxs)("div",{children:[e.name," (",t,")"]})})},e._id)}))})]})})]})}),(0,q.jsx)(B,{in:2===V,direction:"right",children:(0,q.jsxs)(x.Ay,{container:!0,spacing:3,sx:{display:2===V?"flex":"none"},children:[(0,q.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsx)(g.A,{required:!0,fullWidth:!0,id:"startDate",name:"startDate",label:"Start Date",type:"date",value:_.startDate,onChange:ae,InputLabelProps:{shrink:!0}})}),(0,q.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsx)(g.A,{required:!0,fullWidth:!0,id:"endDate",name:"endDate",label:"End Date",type:"date",value:_.endDate,onChange:ae,InputLabelProps:{shrink:!0}})}),(0,q.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsx)(g.A,{fullWidth:!0,id:"budget",name:"budget",label:"Budget",type:"number",value:_.budget,onChange:ae,InputProps:{startAdornment:"$"}})}),(0,q.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,q.jsx)(g.A,{fullWidth:!0,id:"costEstimate",name:"costEstimate",label:"Cost Estimate",type:"number",value:_.costEstimate,onChange:ae,InputProps:{startAdornment:"$"}})})]})}),(0,q.jsxs)(l.A,{display:"flex",justifyContent:"space-between",mt:4,sx:{"& .MuiButton-root":{minWidth:100}},children:[(0,q.jsx)(P.A,{variant:"outlined",onClick:()=>{G(""),V>0&&X(V-1)},disabled:0===V,startIcon:(0,q.jsx)(L.A,{}),children:"Back"}),(0,q.jsxs)(l.A,{children:[c&&(0,q.jsx)(D.A,{title:"Generate project details using AI",children:(0,q.jsx)(P.A,{onClick:c,startIcon:(0,q.jsx)(w.A,{}),sx:{mr:2},children:"AI Assist"})}),(0,q.jsxs)(P.A,{variant:"contained",onClick:2===V?ie:ne,endIcon:V<2?(0,q.jsx)(k.A,{}):null,disabled:K,children:[2===V?r?"Update":"Create":"Next",K&&(0,q.jsx)(d.A,{size:24,sx:{ml:1}})]})]})]})]})]}),(0,q.jsx)(C.A,{open:!!z||!!Y,autoHideDuration:6e3,onClose:()=>{G(""),Z("")},children:(0,q.jsx)(h.A,{onClose:()=>{G(""),Z("")},severity:z?"error":"success",sx:{width:"100%"},children:z||Y})})]})})}))},18804:(e,t,r)=>{r.r(t),r.d(t,{default:()=>o});var a=r(65043),s=r(11046),n=r(92559),i=r(73216),c=r(70579);const o=function(){const[e,t]=(0,a.useState)(null),{projectId:r}=(0,i.g)();return(0,a.useEffect)((()=>{(async()=>{try{const e=await s.A.getProject(r);t(e.data)}catch(e){console.error("Failed to fetch project",e)}})()}),[r]),(0,c.jsx)("div",{children:e?(0,c.jsx)(n.A,{isEdit:!0,projectData:e,onSubmit:(e,t)=>s.A.update(e,t)}):(0,c.jsx)("p",{children:"Loading..."})})}},11046:(e,t,r)=>{r.d(t,{A:()=>s});var a=r(50214);const s={getAll:()=>a.A.get("/projects"),get:e=>a.A.get("/projects/".concat(e)),create:e=>a.A.post("/projects",e),update:(e,t)=>a.A.put("/projects/".concat(e),t),remove:e=>a.A.delete("/projects/".concat(e)),removeAll:()=>a.A.delete("/projects"),findByTitle:e=>a.A.get("/projects?title=".concat(e)),getProjectProgress:e=>a.A.get("/projects/".concat(e,"/progress")),getBudgetAnalytics:e=>a.A.get("/projects/".concat(e,"/budget-analytics")),getTeamPerformance:e=>a.A.get("/projects/".concat(e,"/team-performance")),searchProjects:e=>a.A.post("/projects/search",e),getProjectMessages:e=>a.A.get("/projects/".concat(e,"/messages")),sendProjectMessage:(e,t)=>a.A.post("/projects/".concat(e,"/messages"),t),exportProjectReport:(e,t)=>a.A.get("/projects/".concat(e,"/export/").concat(t)),scheduleReport:(e,t)=>a.A.post("/projects/".concat(e,"/schedule-report"),t),getProjectAnalytics:e=>a.A.get("/projects/".concat(e,"/analytics")),getProjectById:e=>a.A.get("/projects/id/".concat(e)),findByTeams:e=>a.A.get("/projects/teams/".concat(e))}}}]);
//# sourceMappingURL=804.fa726280.chunk.js.map