"use strict";(self.webpackChunkpfefront=self.webpackChunkpfefront||[]).push([[804],{92559:(e,t,r)=>{r.d(t,{A:()=>M});var s=r(89379),a=r(65043),n=r(34535),c=r(12299),o=r(24836),i=r(56258),l=r(7353),d=r(81637),u=r(87234),p=r(61596),j=r(76839),m=r(25078),A=r(50186),h=r(14194),x=r(68903),g=r(15795),f=r(53193),b=r(79190),y=r(69285),v=r(32143),D=r(42518),P=r(18483),C=r(40794),I=r(73216),S=r(99012),N=r(71330),E=r(11046),L=r(20916),T=r(94167),w=r(80638),k=r(70579);const q=(0,n.Ay)(c.A)((e=>{let{theme:t}=e;return{"& .MuiStepLabel-label":{color:t.palette.text.secondary,"&.Mui-active":{color:t.palette.primary.main,fontWeight:600},"&.Mui-completed":{color:t.palette.success.main}}}})),B=e=>{let{in:t,direction:r="left",children:s}=e;return(0,k.jsx)(o.A,{direction:r,in:t,mountOnEnter:!0,unmountOnExit:!0,children:(0,k.jsx)(i.A,{in:t,children:(0,k.jsx)("div",{children:s})})})},W=["Basic Information","Team & Leadership","Timeline & Budget"],M=(0,a.forwardRef)(((e,t)=>{let{isEdit:r=!1,projectData:n=null,onSubmit:c,onAiClick:o,initialProjectType:M}=e;const[F,K]=(0,a.useState)({projectName:"",projectDescription:"",projectType:M||"",projectKey:"",startDate:"",endDate:"",projectLead:"",createdBy:localStorage.getItem("userId"),teams:[],budget:"",costEstimate:""}),[R,U]=(0,a.useState)(!1),[_,H]=(0,a.useState)([]),[O,$]=(0,a.useState)([]),[z,G]=(0,a.useState)(""),[Y,Z]=(0,a.useState)(""),[J,Q]=(0,a.useState)(!0),[V,X]=(0,a.useState)(0),ee=(0,I.Zp)(),{projectId:te}=(0,I.g)(),re=localStorage.getItem("userId");(0,a.useEffect)((()=>{(async()=>{try{const[e,t]=await Promise.all([S.A.getAll(),N.A.getAll()]);if(H(e.data),$(t.data),r&&te&&J){const e=await E.A.getProject(te);K(e.data),Q(!1)}}catch(z){console.error("Error fetching data:",z),G("Failed to load required data")}})()}),[te,r,J]),(0,a.useImperativeHandle)(t,(()=>({updateFormData:e=>{K((t=>(0,s.A)((0,s.A)({},t),e)))}})));const se=e=>{const{name:t,value:r}=e.target;K((e=>{const a=(0,s.A)((0,s.A)({},e),{},{[t]:r});return("projectName"===t||"startDate"===t)&&a.projectName&&a.startDate&&(a.projectKey=((e,t)=>{if(!e||!t)return"";const r=e.substring(0,2).toUpperCase(),s=new Date(t),a=(s.getMonth()+1).toString().padStart(2,"0"),n=s.getFullYear().toString().slice(2);return"".concat(r).concat(a).concat(n)})(a.projectName,a.startDate)),a}))},ae=()=>{if(0===V){if(!F.projectName.trim())return"Project Name is required";if(!F.projectDescription.trim())return"Project Description is required";if(!F.projectType.trim())return"Project Type is required"}else if(1===V){if(!F.projectLead)return"Project Lead is required"}else if(2===V){if(!F.startDate)return"Start Date is required";if(!F.endDate)return"End Date is required";if(new Date(F.endDate)<=new Date(F.startDate))return"End Date must be after Start Date";if(F.budget&&isNaN(Number(F.budget)))return"Budget must be a valid number";if(F.costEstimate&&isNaN(Number(F.costEstimate)))return"Cost Estimate must be a valid number"}return null},ne=()=>{const e=ae();e?G(e):V<2&&X(V+1)},ce=async e=>{e.preventDefault(),U(!0),G(""),Z("");const t=ae();if(t)return G(t),void U(!1);if(2===V)try{const e=(0,s.A)((0,s.A)({},F),{},{createdBy:re});c&&(await c(te,e),Z(r?"Project updated successfully!":"Project created successfully!"),setTimeout((()=>ee("/projects")),2e3))}catch(z){console.error("Failed to submit project",z);let t="Failed to submit project. Please try again.";t=z.response?z.response.data.message||t:z.request?"No response received from server. Please check your connection.":z.message||t,G(t)}finally{U(!1)}else ne()};return R&&!J?(0,k.jsx)(l.A,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",children:(0,k.jsx)(d.A,{})}):(0,k.jsx)(l.A,{sx:{width:"100%",mb:4},children:(0,k.jsxs)(u.A,{component:"main",maxWidth:"md",children:[(0,k.jsxs)(p.A,{elevation:6,sx:{p:{xs:2,sm:4},mt:3,borderRadius:2,position:"relative",overflow:"hidden"},children:[(0,k.jsx)(j.A,{activeStep:V,alternativeLabel:!0,nonLinear:!0,sx:{mb:4,"& .MuiStepConnector-line":{borderColor:"rgba(0, 0, 0, 0.12)"}},children:W.map(((e,t)=>(0,k.jsx)(m.A,{completed:t<V,children:(0,k.jsx)(A.A,{onClick:()=>(e=>{const t=ae();!t||e<V?(X(e),G("")):G(t)})(t),children:(0,k.jsx)(q,{children:e})})},e)))}),z&&(0,k.jsx)(i.A,{in:!!z,children:(0,k.jsx)(h.A,{severity:"error",sx:{mb:3},onClose:()=>G(""),children:z})}),(0,k.jsxs)(l.A,{component:"form",onSubmit:ce,children:[(0,k.jsx)(B,{in:0===V,direction:"left",children:(0,k.jsxs)(x.Ay,{container:!0,spacing:3,sx:{display:0===V?"flex":"none"},children:[(0,k.jsx)(x.Ay,{item:!0,xs:12,children:(0,k.jsx)(g.A,{required:!0,fullWidth:!0,id:"projectName",name:"projectName",label:"Project Name",value:F.projectName,onChange:se,autoFocus:!0})}),(0,k.jsx)(x.Ay,{item:!0,xs:12,children:(0,k.jsx)(g.A,{required:!0,fullWidth:!0,multiline:!0,rows:4,id:"projectDescription",name:"projectDescription",label:"Project Description",value:F.projectDescription,onChange:se})}),(0,k.jsx)(x.Ay,{item:!0,xs:12,children:(0,k.jsx)(g.A,{fullWidth:!0,id:"projectKey",name:"projectKey",label:"Project Key",value:F.projectKey,disabled:!0,helperText:"Auto-generated from Project Name and Start Date"})})]})}),(0,k.jsx)(B,{in:1===V,direction:V>1?"left":"right",children:(0,k.jsxs)(x.Ay,{container:!0,spacing:3,sx:{display:1===V?"flex":"none"},children:[(0,k.jsx)(x.Ay,{item:!0,xs:12,children:(0,k.jsxs)(f.A,{fullWidth:!0,children:[(0,k.jsx)(b.A,{id:"projectLead-label",children:"Project Lead"}),(0,k.jsx)(y.A,{required:!0,labelId:"projectLead-label",id:"projectLead",name:"projectLead",value:F.projectLead,onChange:se,label:"Project Lead",children:O.map((e=>(0,k.jsx)(v.A,{value:e._id,children:e.name},e._id)))})]})}),(0,k.jsx)(x.Ay,{item:!0,xs:12,children:(0,k.jsxs)(f.A,{fullWidth:!0,children:[(0,k.jsx)(b.A,{id:"teams-label",children:"Teams"}),(0,k.jsx)(y.A,{labelId:"teams-label",id:"teams",multiple:!0,value:F.teams,onChange:e=>{const{value:t}=e.target;K((e=>(0,s.A)((0,s.A)({},e),{},{teams:t})))},label:"Teams",children:_.map((e=>(0,k.jsx)(v.A,{value:e._id,children:e.name},e._id)))})]})})]})}),(0,k.jsx)(B,{in:2===V,direction:"right",children:(0,k.jsxs)(x.Ay,{container:!0,spacing:3,sx:{display:2===V?"flex":"none"},children:[(0,k.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,k.jsx)(g.A,{required:!0,fullWidth:!0,id:"startDate",name:"startDate",label:"Start Date",type:"date",value:F.startDate,onChange:se,InputLabelProps:{shrink:!0}})}),(0,k.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,k.jsx)(g.A,{required:!0,fullWidth:!0,id:"endDate",name:"endDate",label:"End Date",type:"date",value:F.endDate,onChange:se,InputLabelProps:{shrink:!0}})}),(0,k.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,k.jsx)(g.A,{fullWidth:!0,id:"budget",name:"budget",label:"Budget",type:"number",value:F.budget,onChange:se,InputProps:{startAdornment:"$"}})}),(0,k.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,k.jsx)(g.A,{fullWidth:!0,id:"costEstimate",name:"costEstimate",label:"Cost Estimate",type:"number",value:F.costEstimate,onChange:se,InputProps:{startAdornment:"$"}})})]})}),(0,k.jsxs)(l.A,{display:"flex",justifyContent:"space-between",mt:4,sx:{"& .MuiButton-root":{minWidth:100}},children:[(0,k.jsx)(D.A,{variant:"outlined",onClick:()=>{G(""),V>0&&X(V-1)},disabled:0===V,startIcon:(0,k.jsx)(L.A,{}),children:"Back"}),(0,k.jsxs)(l.A,{children:[o&&(0,k.jsx)(P.A,{title:"Generate project details using AI",children:(0,k.jsx)(D.A,{onClick:o,startIcon:(0,k.jsx)(T.A,{}),sx:{mr:2},children:"AI Assist"})}),(0,k.jsxs)(D.A,{variant:"contained",onClick:2===V?ce:ne,endIcon:V<2?(0,k.jsx)(w.A,{}):null,disabled:R,children:[2===V?r?"Update":"Create":"Next",R&&(0,k.jsx)(d.A,{size:24,sx:{ml:1}})]})]})]})]})]}),(0,k.jsx)(C.A,{open:!!z||!!Y,autoHideDuration:6e3,onClose:()=>{G(""),Z("")},children:(0,k.jsx)(h.A,{onClose:()=>{G(""),Z("")},severity:z?"error":"success",sx:{width:"100%"},children:z||Y})})]})})}))},18804:(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var s=r(65043),a=r(11046),n=r(92559),c=r(73216),o=r(70579);const i=function(){const[e,t]=(0,s.useState)(null),{projectId:r}=(0,c.g)();return(0,s.useEffect)((()=>{(async()=>{try{const e=await a.A.getProject(r);t(e.data)}catch(e){console.error("Failed to fetch project",e)}})()}),[r]),(0,o.jsx)("div",{children:e?(0,o.jsx)(n.A,{isEdit:!0,projectData:e,onSubmit:(e,t)=>a.A.update(e,t)}):(0,o.jsx)("p",{children:"Loading..."})})}},11046:(e,t,r)=>{r.d(t,{A:()=>a});var s=r(50214);const a={getAll:()=>s.A.get("/projects"),get:e=>s.A.get("/projects/".concat(e)),create:e=>s.A.post("/projects",e),update:(e,t)=>s.A.put("/projects/".concat(e),t),remove:e=>s.A.delete("/projects/".concat(e)),removeAll:()=>s.A.delete("/projects"),findByTitle:e=>s.A.get("/projects?title=".concat(e)),getProjectProgress:e=>s.A.get("/projects/".concat(e,"/progress")),getBudgetAnalytics:e=>s.A.get("/projects/".concat(e,"/budget-analytics")),getTeamPerformance:e=>s.A.get("/projects/".concat(e,"/team-performance")),searchProjects:e=>s.A.post("/projects/search",e),getProjectMessages:e=>s.A.get("/projects/".concat(e,"/messages")),sendProjectMessage:(e,t)=>s.A.post("/projects/".concat(e,"/messages"),t),exportProjectReport:(e,t)=>s.A.get("/projects/".concat(e,"/export/").concat(t)),scheduleReport:(e,t)=>s.A.post("/projects/".concat(e,"/schedule-report"),t),getProjectAnalytics:e=>s.A.get("/projects/".concat(e,"/analytics")),getProjectById:e=>s.A.get("/projects/id/".concat(e))}},99012:(e,t,r)=>{r.d(t,{A:()=>a});var s=r(50214);const a={getAll:()=>s.A.get("/teams"),getTeam:e=>s.A.get("/teams/".concat(e)),createTeam:e=>s.A.post("/teams",e),updateTeam:(e,t)=>s.A.put("/teams/".concat(e),t),deleteTeam:e=>s.A.delete("/teams/".concat(e)),addMember:(e,t)=>s.A.post("/teams/".concat(e,"/members"),{userId:t}),removeMember:(e,t)=>s.A.delete("/teams/".concat(e,"/members"),{data:{userId:t}}),assignToProject:(e,t)=>s.A.post("/teams/".concat(e,"/projects"),{projectId:t})}},71330:(e,t,r)=>{r.d(t,{A:()=>a});var s=r(50214);const a={getAll:()=>s.A.get("/users"),create:e=>s.A.post("/users",e),deleteUsers:e=>s.A.delete("/users/".concat(e)),getUser:e=>s.A.get("/users/id/".concat(e)),update:(e,t)=>s.A.put("/users/".concat(e),t),getUserByRole:e=>s.A.get("/users/role/".concat(e))}}}]);
//# sourceMappingURL=804.123baa3e.chunk.js.map