"use strict";(self.webpackChunkpfefront=self.webpackChunkpfefront||[]).push([[522],{14512:(e,s,t)=>{t.r(s),t.d(s,{default:()=>E});var i=t(89379),r=t(65043),o=t(90035),l=t(26600),a=t(35316),n=t(14194),c=t(67784),d=t(53193),x=t(79190),h=t(69285),u=t(32143),p=t(7353),A=t(94496),g=t(42518),j=t(43845),m=t(35721),f=t(71322),b=t(17392),y=t(48734),v=t(29347),C=t(70141),k=t(51387),w=t(28016),S=t(11046),D=t(40293),I=t(70579);const E=e=>{let{open:s,onClose:t,onBacklogCreated:E}=e;const[W,z]=(0,r.useState)([]),[B,P]=(0,r.useState)([]),[_,T]=(0,r.useState)([]),[F,N]=(0,r.useState)(!0),[L,R]=(0,r.useState)(null),[M,H]=(0,r.useState)({name:"",project:"",items:[]}),[O,q]=(0,r.useState)(!1),[U,V]=(0,r.useState)({title:"",description:"",type:"story",status:"todo",project:""});(0,r.useEffect)((()=>{(async()=>{try{N(!0);const[e,s]=await Promise.all([S.A.getAll(),D.A.getAll()]);z(e.data||[]),P(s.data||[]),R(null)}catch(e){R("Failed to fetch data")}finally{N(!1)}})()}),[]);return(0,I.jsxs)(o.A,{open:s,onClose:t,maxWidth:"sm",fullWidth:!0,children:[(0,I.jsx)(l.A,{children:"Add New Backlog"}),(0,I.jsxs)(a.A,{children:[L&&(0,I.jsx)(n.A,{severity:"error",children:L}),(0,I.jsx)(c.A,{label:"Backlog Name",fullWidth:!0,margin:"normal",value:M.name,onChange:e=>H((0,i.A)((0,i.A)({},M),{},{name:e.target.value}))}),(0,I.jsxs)(d.A,{fullWidth:!0,margin:"normal",children:[(0,I.jsx)(x.A,{children:"Project"}),(0,I.jsxs)(h.A,{value:M.project,onChange:e=>(e=>{H((s=>(0,i.A)((0,i.A)({},s),{},{project:e,items:[]}))),V((s=>(0,i.A)((0,i.A)({},s),{},{project:e})));const s=B.filter((s=>s.project===e));T(s)})(e.target.value),displayEmpty:!0,children:[(0,I.jsx)(u.A,{value:"",children:(0,I.jsx)("em",{children:"Select a Project"})}),W.map((e=>(0,I.jsx)(u.A,{value:e._id,children:e.projectName},e._id)))]})]}),(0,I.jsxs)(p.A,{display:"flex",alignItems:"center",justifyContent:"space-between",sx:{mt:2},children:[(0,I.jsx)(A.A,{variant:"h6",children:"Backlog Items"}),(0,I.jsx)(g.A,{variant:"outlined",startIcon:(0,I.jsx)(C.A,{}),onClick:()=>q(!0),children:"Add Backlog Item"})]}),(0,I.jsxs)(d.A,{fullWidth:!0,margin:"normal",children:[(0,I.jsx)(x.A,{children:"Select Items"}),(0,I.jsx)(h.A,{multiple:!0,value:M.items,onChange:e=>H((0,i.A)((0,i.A)({},M),{},{items:e.target.value})),renderValue:e=>(0,I.jsx)(p.A,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.map((e=>{var s;return(0,I.jsx)(j.A,{label:(null===(s=_.find((s=>s._id===e)))||void 0===s?void 0:s.title)||""},e)}))}),children:_.map((e=>(0,I.jsx)(u.A,{value:e._id,children:e.title},e._id)))})]}),(0,I.jsx)(m.A,{dense:!0,children:M.items.map((e=>{var s;return(0,I.jsx)(f.Ay,{secondaryAction:(0,I.jsx)(b.A,{edge:"end",onClick:()=>(e=>{H((s=>(0,i.A)((0,i.A)({},s),{},{items:s.items.filter((s=>s!==e))})))})(e),children:(0,I.jsx)(k.A,{})}),children:(0,I.jsx)(y.A,{primary:(null===(s=_.find((s=>s._id===e)))||void 0===s?void 0:s.title)||""})},e)}))})]}),(0,I.jsxs)(v.A,{children:[(0,I.jsx)(g.A,{onClick:t,children:"Cancel"}),(0,I.jsx)(g.A,{variant:"contained",onClick:async()=>{if(M.name&&M.project)try{await w.A.create(M),H({name:"",project:"",items:[]}),E(),t()}catch(e){R("Failed to create backlog")}else R("Name and Project are required fields")},children:"Create"})]}),(0,I.jsxs)(o.A,{open:O,onClose:()=>q(!1),maxWidth:"sm",fullWidth:!0,children:[(0,I.jsx)(l.A,{children:"Add Backlog Item"}),(0,I.jsxs)(a.A,{children:[(0,I.jsx)(c.A,{label:"Title",fullWidth:!0,margin:"normal",value:U.title,onChange:e=>V((0,i.A)((0,i.A)({},U),{},{title:e.target.value}))}),(0,I.jsx)(c.A,{label:"Description",fullWidth:!0,margin:"normal",value:U.description,onChange:e=>V((0,i.A)((0,i.A)({},U),{},{description:e.target.value}))}),(0,I.jsxs)(d.A,{fullWidth:!0,margin:"normal",children:[(0,I.jsx)(x.A,{children:"Type"}),(0,I.jsxs)(h.A,{value:U.type,onChange:e=>V((0,i.A)((0,i.A)({},U),{},{type:e.target.value})),children:[(0,I.jsx)(u.A,{value:"story",children:"Story"}),(0,I.jsx)(u.A,{value:"task",children:"Task"}),(0,I.jsx)(u.A,{value:"bug",children:"Bug"})]})]}),(0,I.jsxs)(d.A,{fullWidth:!0,margin:"normal",children:[(0,I.jsx)(x.A,{children:"Status"}),(0,I.jsxs)(h.A,{value:U.status,onChange:e=>V((0,i.A)((0,i.A)({},U),{},{status:e.target.value})),children:[(0,I.jsx)(u.A,{value:"todo",children:"To Do"}),(0,I.jsx)(u.A,{value:"in-progress",children:"In Progress"}),(0,I.jsx)(u.A,{value:"done",children:"Done"})]})]})]}),(0,I.jsxs)(v.A,{children:[(0,I.jsx)(g.A,{onClick:()=>q(!1),children:"Cancel"}),(0,I.jsx)(g.A,{variant:"contained",onClick:async()=>{if(U.title&&U.project)try{const e=await D.A.create(U);P((s=>[...s,e.data])),T((s=>[...s,e.data])),H((s=>(0,i.A)((0,i.A)({},s),{},{items:[...s.items,e.data._id]}))),V({title:"",description:"",type:"story",status:"todo",project:M.project}),q(!1)}catch(e){R("Failed to create backlog item")}else R("Backlog Item title and project are required")},children:"Add Item"})]})]})]})}},82754:(e,s,t)=>{t.r(s),t.d(s,{default:()=>I});var i=t(89379),r=t(65043),o=t(26240),l=t(85442),a=t(90035),n=t(26600),c=t(35316),d=t(14194),x=t(68903),h=t(67784),u=t(53193),p=t(79190),A=t(69285),g=t(32143),j=t(7353),m=t(43845),f=t(94496),b=t(81673),y=t(29347),v=t(42518),C=t(81637),k=t(98008),w=t(11046),S=t(94160),D=t(70579);const I=e=>{let{open:s,onClose:t,projectId:I,epic:E}=e;const W=(0,o.A)(),z=(0,l.A)(W.breakpoints.down("sm")),[B,P]=(0,r.useState)(!1),[_,T]=(0,r.useState)(""),[F,N]=(0,r.useState)(""),[L,R]=(0,r.useState)([]),[M,H]=(0,r.useState)([]),[O,q]=(0,r.useState)({name:"",description:"",project:I||"",status:"to do",priority:"medium",startDate:"",dueDate:"",color:"#0052CC",labels:[],watchers:[],issues:[]});(0,r.useEffect)((()=>{(async()=>{try{const[e,s]=await Promise.all([w.A.getAll(),S.A.getAll()]);R(e.data),H(s.data)}catch(e){console.error("Error loading data:",e),T("Failed to load required data")}})()}),[]),(0,r.useEffect)((()=>{q(E?{name:E.name||"",description:E.description||"",project:E.project||I||"",status:E.status||"to do",priority:E.priority||"medium",startDate:E.startDate?new Date(E.startDate).toISOString().split("T")[0]:"",dueDate:E.dueDate?new Date(E.dueDate).toISOString().split("T")[0]:"",color:E.color||"#0052CC",labels:E.labels||[],watchers:E.watchers||[],issues:E.issues||[]}:{name:"",description:"",project:I||"",status:"to do",priority:"medium",startDate:"",dueDate:"",color:"#0052CC",labels:[],watchers:[],issues:[]})}),[E,I]);const U=e=>{const{name:s,value:t}=e.target;if(console.log("Handle change:",s,t),"issues"===s)console.log("Issues selected:",t),q((e=>{const s=(0,i.A)((0,i.A)({},e),{},{issues:Array.isArray(t)?t:[]});return console.log("New epic data after issues change:",s),s}));else{const e="project"===s?t||"":""===t?void 0:t;q((t=>(0,i.A)((0,i.A)({},t),{},{[s]:e})))}},V=()=>{q({name:"",description:"",project:I||"",status:"to do",priority:"medium",startDate:"",dueDate:"",color:"#0052CC",labels:[],watchers:[],issues:[]}),T(""),N(""),t(!1)},G=e=>{switch(e){case"to do":default:return{bg:"#E3F2FD",color:"#1976D2"};case"in progress":return{bg:"#F7DC6F",color:"#FFD700"};case"done":return{bg:"#C6F4D6",color:"#2E865F"}}},Q=e=>{switch(e){case"highest":return"#FF0000";case"high":return"#FFA07A";case"medium":default:return"#FFFF00";case"low":return"#32CD32";case"lowest":return"#008000"}};return(0,D.jsxs)(a.A,{open:s,onClose:V,fullScreen:z,maxWidth:"sm",fullWidth:!0,children:[(0,D.jsx)(n.A,{children:E?"Edit Epic":"Create New Epic"}),(0,D.jsxs)("form",{onSubmit:async e=>{var s;e.preventDefault(),P(!0),T(""),N("");const i=localStorage.getItem("userId");if(!i)return T("User not authenticated"),void P(!1);if(null===(s=O.name)||void 0===s||!s.trim())return T("Epic name is required"),void P(!1);try{var r,o,l,a,n,c,d,x;const e={name:O.name.trim(),description:null===(r=O.description)||void 0===r?void 0:r.trim(),status:(null===(o=O.status)||void 0===o?void 0:o.toLowerCase())||"to do",priority:(null===(l=O.priority)||void 0===l?void 0:l.toLowerCase())||"medium",owner:i,project:O.project||I||null,startDate:O.startDate||void 0,dueDate:O.dueDate||void 0,color:O.color||"#0052CC",labels:(null===(a=O.labels)||void 0===a?void 0:a.length)>0?O.labels:void 0,watchers:(null===(n=O.watchers)||void 0===n?void 0:n.length)>0?O.watchers:void 0,issues:(null===(c=O.issues)||void 0===c?void 0:c.length)>0?O.issues:void 0};let s;if(Object.keys(e).forEach((s=>{void 0===e[s]&&delete e[s]})),console.log("Submitting epic data:",e),E?(s=await k.A.update(E._id,e),console.log("Epic updated:",s.data),N("Epic updated successfully!")):(s=await k.A.create(e),console.log("Epic created:",s.data),N("Epic created successfully!")),!E&&null!==(d=s.data)&&void 0!==d&&d._id&&(null===(x=O.issues)||void 0===x?void 0:x.length)>0)try{await Promise.all(O.issues.map((e=>S.A.update(e,{epic:s.data._id})))),console.log("Issues updated successfully")}catch(p){console.error("Error updating issues:",p)}setTimeout((()=>{P(!1),t(!0)}),1e3)}catch(A){var h,u;console.error("Error submitting epic:",A);const e=(null===(h=A.response)||void 0===h||null===(u=h.data)||void 0===u?void 0:u.message)||"Failed to save epic. Please check all required fields.";T(e),P(!1)}},children:[(0,D.jsxs)(c.A,{children:[_&&(0,D.jsx)(d.A,{severity:"error",sx:{mb:2},children:_}),F&&(0,D.jsx)(d.A,{severity:"success",sx:{mb:2},children:F}),(0,D.jsxs)(x.Ay,{container:!0,spacing:2,children:[(0,D.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,D.jsx)(h.A,{name:"key",label:"Epic Key (Optional)",value:O.key,onChange:U,fullWidth:!0,size:z?"small":"medium",helperText:"Unique identifier for project-linked epics"})}),(0,D.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,D.jsx)(h.A,{name:"name",label:"Epic Name",value:O.name,onChange:U,fullWidth:!0,required:!0,size:z?"small":"medium"})}),(0,D.jsx)(x.Ay,{item:!0,xs:12,children:(0,D.jsx)(h.A,{name:"description",label:"Description",value:O.description,onChange:U,fullWidth:!0,multiline:!0,rows:3,size:z?"small":"medium"})}),(0,D.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,D.jsxs)(u.A,{fullWidth:!0,size:z?"small":"medium",children:[(0,D.jsx)(p.A,{children:"Project (Optional)"}),(0,D.jsxs)(A.A,{name:"project",value:O.project||"",onChange:U,label:"Project (Optional)",children:[(0,D.jsx)(g.A,{value:"",children:(0,D.jsx)("em",{children:"None"})}),L.map((e=>(0,D.jsx)(g.A,{value:e._id,children:e.projectName},e._id)))]})]})}),(0,D.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,D.jsxs)(u.A,{fullWidth:!0,size:z?"small":"medium",children:[(0,D.jsx)(p.A,{children:"Status"}),(0,D.jsxs)(A.A,{name:"status",value:O.status,onChange:U,label:"Status",children:[(0,D.jsx)(g.A,{value:"to do",children:"To Do"}),(0,D.jsx)(g.A,{value:"in progress",children:"In Progress"}),(0,D.jsx)(g.A,{value:"done",children:"Done"})]})]})}),(0,D.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,D.jsxs)(u.A,{fullWidth:!0,size:z?"small":"medium",children:[(0,D.jsx)(p.A,{children:"Priority"}),(0,D.jsxs)(A.A,{name:"priority",value:O.priority,onChange:U,label:"Priority",children:[(0,D.jsx)(g.A,{value:"highest",children:"Highest"}),(0,D.jsx)(g.A,{value:"high",children:"High"}),(0,D.jsx)(g.A,{value:"medium",children:"Medium"}),(0,D.jsx)(g.A,{value:"low",children:"Low"}),(0,D.jsx)(g.A,{value:"lowest",children:"Lowest"})]})]})}),(0,D.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,D.jsx)(h.A,{name:"color",label:"Epic Color",type:"color",value:O.color,onChange:U,fullWidth:!0,size:z?"small":"medium",InputLabelProps:{shrink:!0}})}),(0,D.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,D.jsx)(h.A,{name:"startDate",label:"Start Date",type:"date",value:O.startDate,onChange:U,fullWidth:!0,size:z?"small":"medium",InputLabelProps:{shrink:!0}})}),(0,D.jsx)(x.Ay,{item:!0,xs:12,sm:6,children:(0,D.jsx)(h.A,{name:"dueDate",label:"Due Date",type:"date",value:O.dueDate,onChange:U,fullWidth:!0,size:z?"small":"medium",InputLabelProps:{shrink:!0}})}),(0,D.jsx)(x.Ay,{item:!0,xs:12,children:(0,D.jsxs)(u.A,{fullWidth:!0,size:z?"small":"medium",children:[(0,D.jsx)(p.A,{id:"issues-label",children:"Issues"}),(0,D.jsx)(A.A,{labelId:"issues-label",name:"issues",multiple:!0,value:O.issues||[],onChange:U,label:"Issues",renderValue:e=>(0,D.jsx)(j.A,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:e.map((e=>{const s=M.find((s=>s._id===e));return(0,D.jsx)(m.A,{label:s?"".concat(s.key," - ").concat(s.title):e,sx:{backgroundColor:s?G(s.status).bg:"#E3F2FD",color:s?G(s.status).color:"#1976D2",fontWeight:500}},e)}))}),MenuProps:{PaperProps:{style:{maxHeight:300}}},children:M&&M.length>0?M.map((e=>(0,D.jsxs)(g.A,{value:e._id,sx:{display:"flex",justifyContent:"space-between",gap:1,py:1},children:[(0,D.jsxs)(j.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,D.jsx)(f.A,{variant:"body2",sx:{fontWeight:600,color:"primary.main",minWidth:"80px"},children:e.key}),(0,D.jsx)(f.A,{variant:"body2",children:e.title})]}),(0,D.jsxs)(j.A,{sx:{display:"flex",gap:1,flexShrink:0},children:[(0,D.jsx)(m.A,{label:e.status,size:"small",sx:{backgroundColor:G(e.status).bg,color:G(e.status).color,height:24}}),(0,D.jsx)(m.A,{label:e.priority,size:"small",sx:{backgroundColor:"white",color:Q(e.priority),border:1,borderColor:Q(e.priority),height:24}})]})]},e._id))):(0,D.jsx)(g.A,{disabled:!0,children:"No issues available"})}),_&&_.includes("issues")&&(0,D.jsx)(b.A,{error:!0,children:_})]})})]})]}),(0,D.jsxs)(y.A,{sx:{p:W.spacing(2)},children:[(0,D.jsx)(v.A,{onClick:V,size:z?"small":"medium",fullWidth:z,children:"Cancel"}),(0,D.jsx)(v.A,{type:"submit",variant:"contained",size:z?"small":"medium",fullWidth:z,disabled:B,sx:{backgroundColor:"#0052CC","&:hover":{backgroundColor:"#0747A6"}},children:B?(0,D.jsx)(C.A,{size:24}):E?"Update Epic":"Create Epic"})]})]})]})}},1522:(e,s,t)=>{t.r(s),t.d(s,{default:()=>be});var i=t(89379),r=t(65043),o=t(73216),l=t(35475),a=t(30335),n=t(67537),c=t(7353),d=t(81045),x=t(94496),h=t(42518),u=t(71806),p=t(84882),A=t(28076),g=t(10039),j=t(73460),m=t(79650),f=t(61596),b=t(53193),y=t(69285),v=t(32143),C=t(43845),k=t(17392),w=t(12110),S=t(26494),D=t(27600),I=t(81637),E=t(22698),W=t(88446),z=t(90035),B=t(26600),P=t(35316),_=t(68903),T=t(35721),F=t(71322),N=t(48734),L=t(29347),R=t(14194),M=t(10611),H=t(92314),O=t(55263),q=t(67784),U=(t(70141),t(51387)),V=t(83560),G=t(93287),Q=t(14149),K=t(62973),X=t(15337),Y=t(1781),Z=t(3632),J=t(59275),$=t(80638),ee=t(87241),se=t(9345),te=t(95190),ie=t(10529),re=t(33438),oe=t(47225),le=t(11046),ae=t(54859),ne=t(98008),ce=t(28016),de=t(40293),xe=t(82754),he=t(14512),ue=t(35964),pe=t(42734),Ae=t(18483),ge=t(70579);const je=e=>{let{epic:s,onEpicClick:t,onEditClick:i,onDeleteClick:r}=e;const[{isDragging:o},l]=(0,pe.i)((()=>({type:"epic",item:{id:s._id,status:s.status},collect:e=>({isDragging:e.isDragging()})})));return(0,ge.jsxs)(w.A,{ref:l,sx:{opacity:o?.5:1,cursor:"move",mb:2,borderRadius:2,boxShadow:"0 1px 3px rgba(0,0,0,0.12)","&:hover":{boxShadow:"0 4px 6px rgba(0,0,0,0.15)"}},children:[(0,ge.jsxs)(S.A,{children:[(0,ge.jsx)(x.A,{variant:"h6",gutterBottom:!0,children:s.name}),(0,ge.jsxs)(c.A,{sx:{display:"flex",gap:1,mb:1},children:[(0,ge.jsx)(C.A,{label:s.status||"To Do",size:"small",sx:{bgcolor:"done"===s.status?"#10b981":"in progress"===s.status?"#3b82f6":"#e2e8f0",color:"to do"===s.status?"#1e293b":"white"}}),(0,ge.jsx)(C.A,{label:s.priority||"Medium",size:"small",sx:{bgcolor:"#e2e8f0",color:"#1e293b"}})]}),(0,ge.jsx)(x.A,{variant:"body2",color:"text.secondary",noWrap:!0,children:s.description||"No description"})]}),(0,ge.jsx)(D.A,{children:(0,ge.jsxs)(c.A,{sx:{display:"flex",justifyContent:"flex-end",width:"100%"},children:[(0,ge.jsx)(Ae.A,{title:"View Details",children:(0,ge.jsx)(k.A,{size:"small",onClick:e=>{e.stopPropagation(),t(s)},sx:{color:"#1e40af"},children:(0,ge.jsx)(Z.A,{fontSize:"small"})})}),(0,ge.jsx)(Ae.A,{title:"Edit Epic",children:(0,ge.jsx)(k.A,{size:"small",onClick:e=>{e.stopPropagation(),i(s)},sx:{color:"#64748b"},children:(0,ge.jsx)(V.A,{fontSize:"small"})})}),(0,ge.jsx)(Ae.A,{title:"Delete Epic",children:(0,ge.jsx)(k.A,{size:"small",onClick:e=>{e.stopPropagation(),r(s._id)},sx:{color:"#ef4444"},children:(0,ge.jsx)(U.A,{fontSize:"small"})})})]})})]})},me=e=>{let{status:s,title:t,epics:i,onDrop:r,onEpicClick:o,onEditClick:l,onDeleteClick:a}=e;const[{isOver:n},d]=(0,ue.H)((()=>({accept:"epic",drop:e=>r(e.id,s),collect:e=>({isOver:e.isOver()})})));return(0,ge.jsxs)(f.A,{ref:d,sx:{minWidth:300,bgcolor:n?"#f1f5f9":"#fff",p:2,borderRadius:2,border:"1px solid #e2e8f0",display:"flex",flexDirection:"column",height:"100%"},children:[(0,ge.jsxs)(x.A,{variant:"h6",sx:{mb:2,color:"#1e293b",fontWeight:600,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[t,(0,ge.jsx)(x.A,{component:"span",sx:{ml:1,fontSize:"0.875rem",color:"#64748b",bgcolor:"#f1f5f9",px:1.5,py:.5,borderRadius:"9999px"},children:(null===i||void 0===i?void 0:i.length)||0})]}),(0,ge.jsx)(c.A,{sx:{flexGrow:1,overflowY:"auto"},children:null===i||void 0===i?void 0:i.map((e=>(0,ge.jsx)(je,{epic:e,onEpicClick:o,onEditClick:l,onDeleteClick:a},e._id)))})]})};var fe=t(2057);const be=()=>{(0,o.Zp)();const{id:e}=(0,o.g)(),[s,t]=(0,r.useState)(null),[ue,pe]=(0,r.useState)([]),[Ae,je]=(0,r.useState)([]),[be,ye]=(0,r.useState)([]),[ve,Ce]=(0,r.useState)([]),[ke,we]=(0,r.useState)([]),[Se,De]=(0,r.useState)(!0),[Ie,Ee]=(0,r.useState)(null),[We,ze]=(0,r.useState)("epics"),[Be,Pe]=(0,r.useState)(null),[_e,Te]=(0,r.useState)(null),[Fe,Ne]=(0,r.useState)(!1),[Le,Re]=(0,r.useState)(!1),[Me,He]=(0,r.useState)(""),[Oe,qe]=(0,r.useState)(null),[Ue,Ve]=(0,r.useState)(localStorage.getItem("projectType")),[Ge,Qe]=(0,r.useState)(""),[Ke,Xe]=(0,r.useState)(!1),[Ye,Ze]=(0,r.useState)("cards"),[Je,$e]=(0,r.useState)({"to do":[],"in progress":[],done:[]}),[es,ss]=(0,r.useState)(null),[ts,is]=(0,r.useState)(!1),[rs,os]=(0,r.useState)(!1),[ls,as]=(0,r.useState)(null),[ns,cs]=(0,r.useState)(!1),ds="to do",xs="in progress",hs="done",us=e=>{ze(e),Pe(null)};(0,r.useEffect)((()=>{(async()=>{De(!0);try{const s=await le.A.getProjectById(e);t(s.data),Qe(s.data.key);const i=await ce.A.getByProject(e);je(i.data);const r=await ne.A.getByProject(e);pe(r.data);const o=await ae.A.getByProject(e);Ce(o.data)}catch(s){console.error("Error fetching project data:",s),Ee(s.message)}finally{De(!1)}})()}),[e]),(0,r.useEffect)((()=>{const e=()=>{const e=localStorage.getItem("projectType");Ve(e)};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)}),[]),(0,r.useEffect)((()=>{if(ue.length>0){const e={"to do":ue.filter((e=>e.status===ds)),"in progress":ue.filter((e=>e.status===xs)),done:ue.filter((e=>e.status===hs))};$e(e)}}),[ue]);const ps=e=>{ss(e),is(!0)},As=e=>{Pe(e),ze("backlog")},gs=async(e,s)=>{try{const t=ue.find((s=>s._id===e));if(!t)return;const r=(0,i.A)((0,i.A)({},t),{},{status:s}),o=ue.map((s=>s._id===e?r:s));pe(o);const l={"to do":o.filter((e=>e.status===ds)),"in progress":o.filter((e=>e.status===xs)),done:o.filter((e=>e.status===hs))};$e(l),await ne.A.update(e,(0,i.A)((0,i.A)({},t),{},{status:s}))}catch(Ie){console.error("Error updating epic status:",Ie);const s=[...ue];pe(s),Ee("Failed to update epic status")}},js=e=>e?"number"===typeof e?e:"object"===typeof e&&e.total>0?Math.round(e.completed/e.total*100):0:0,ms=()=>(0,ge.jsxs)(c.A,{sx:{display:"flex",gap:2,overflowX:"auto",p:2,minHeight:600},children:[(0,ge.jsx)(me,{status:ds,title:"To Do",epics:Je[ds],onDrop:gs,onEpicClick:ps,onEditClick:ks,onDeleteClick:Ss}),(0,ge.jsx)(me,{status:xs,title:"In Progress",epics:Je[xs],onDrop:gs,onEpicClick:ps,onEditClick:ks,onDeleteClick:Ss}),(0,ge.jsx)(me,{status:hs,title:"Done",epics:Je[hs],onDrop:gs,onEpicClick:ps,onEditClick:ks,onDeleteClick:Ss})]}),fs=()=>Ae&&0!==Ae.length?(0,ge.jsx)(m.A,{component:f.A,elevation:0,sx:{border:"1px solid #e2e8f0",borderRadius:2,"& .MuiTableCell-head":{bgcolor:"#f8fafc",borderBottom:"2px solid #e2e8f0"},"& .MuiTableRow-root:hover":{bgcolor:"#f1f5f9"},"& .MuiTableCell-root":{borderColor:"#e2e8f0"}},children:(0,ge.jsxs)(u.A,{children:[(0,ge.jsx)(p.A,{children:(0,ge.jsxs)(A.A,{children:[(0,ge.jsx)(g.A,{sx:{fontWeight:600,color:"#475569"},children:"Name"}),(0,ge.jsx)(g.A,{sx:{fontWeight:600,color:"#475569"},children:"Description"}),(0,ge.jsx)(g.A,{sx:{fontWeight:600,color:"#475569"},children:"Status"}),(0,ge.jsx)(g.A,{sx:{fontWeight:600,color:"#475569"},children:"Progress"}),(0,ge.jsx)(g.A,{align:"right",sx:{fontWeight:600,color:"#475569"},children:"Actions"})]})}),(0,ge.jsx)(j.A,{children:Ae.map((s=>(0,ge.jsxs)(A.A,{sx:{"&:last-child td, &:last-child th":{border:0},"&:hover":{bgcolor:"#f8fafc"},cursor:"pointer"},onClick:()=>As(s),children:[(0,ge.jsx)(g.A,{sx:{color:"#1e293b"},children:s.name}),(0,ge.jsx)(g.A,{sx:{color:"#475569"},children:s.description?s.description.length>50?"".concat(s.description.substring(0,50),"..."):s.description:"No description"}),(0,ge.jsx)(g.A,{children:(0,ge.jsx)(C.A,{label:s.status||"to do",size:"small",sx:{bgcolor:"done"===s.status?"#dcfce7":"in progress"===s.status?"#dbeafe":"#f1f5f9",color:"done"===s.status?"#059669":"in progress"===s.status?"#2563eb":"#475569",textTransform:"capitalize",fontWeight:500}})}),(0,ge.jsx)(g.A,{children:(0,ge.jsxs)(c.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,ge.jsx)(I.A,{variant:"determinate",value:"object"===typeof s.progress?s.progress.completed/s.progress.total*100:s.progress||0,size:24,thickness:4,sx:{color:("object"===typeof s.progress?s.progress.completed/s.progress.total*100:s.progress||0)>=100?"#10b981":"#3b82f6"}}),(0,ge.jsx)(x.A,{variant:"body2",sx:{color:"#475569"},children:"object"===typeof s.progress?"".concat((s.progress.completed/s.progress.total*100).toFixed(0),"%"):"".concat(s.progress||0,"%")})]})}),(0,ge.jsx)(g.A,{align:"right",children:(0,ge.jsxs)(c.A,{sx:{display:"flex",gap:1,justifyContent:"flex-end"},children:[(0,ge.jsx)(k.A,{size:"small",onClick:e=>{e.stopPropagation(),As(s)},sx:{color:"#3b82f6"},children:(0,ge.jsx)(Z.A,{fontSize:"small"})}),(0,ge.jsx)(k.A,{size:"small",onClick:e=>{e.stopPropagation(),(e=>{setSelectedBacklog(e),He(e.name),Re(!0)})(s)},sx:{color:"#3b82f6"},children:(0,ge.jsx)(V.A,{fontSize:"small"})}),(0,ge.jsx)(k.A,{size:"small",onClick:t=>{t.stopPropagation(),(async s=>{try{await ce.A.delete(s);const t=await ce.A.getByProject(e);je(t.data)}catch(t){Ee("Failed to delete backlog. Please try again.")}})(s._id)},sx:{color:"#ef4444"},children:(0,ge.jsx)(U.A,{fontSize:"small"})})]})})]},s._id)))})]})}):(0,ge.jsx)(c.A,{sx:{p:2,textAlign:"center"},children:(0,ge.jsx)(x.A,{variant:"body1",color:"textSecondary",children:"No backlog items found"})}),bs=()=>ue&&0!==ue.length?(0,ge.jsx)(m.A,{component:f.A,children:(0,ge.jsxs)(u.A,{children:[(0,ge.jsx)(p.A,{children:(0,ge.jsxs)(A.A,{children:[(0,ge.jsx)(g.A,{children:"Name"}),(0,ge.jsx)(g.A,{children:"Description"}),(0,ge.jsx)(g.A,{children:"Status"}),(0,ge.jsx)(g.A,{children:"Progress"}),(0,ge.jsx)(g.A,{children:"Timeline"}),(0,ge.jsx)(g.A,{align:"right",children:"Actions"})]})}),(0,ge.jsx)(j.A,{children:ue.map((e=>{const s=js(e.progress);return(0,ge.jsxs)(A.A,{children:[(0,ge.jsx)(g.A,{children:e.name}),(0,ge.jsx)(g.A,{children:e.description}),(0,ge.jsx)(g.A,{children:(0,ge.jsx)(b.A,{size:"small",onClick:e=>e.stopPropagation(),children:(0,ge.jsxs)(y.A,{value:e.status||ds,onChange:s=>ys(e._id,s.target.value),sx:{minWidth:120,bgcolor:e.status===hs?"#dcfce7":e.status===xs?"#dbeafe":"#f1f5f9",color:e.status===ds?"#1e293b":"white",fontWeight:500},children:[(0,ge.jsx)(v.A,{value:ds,children:"To Do"}),(0,ge.jsx)(v.A,{value:xs,children:"In Progress"}),(0,ge.jsx)(v.A,{value:hs,children:"Done"})]})})}),(0,ge.jsx)(g.A,{children:(0,ge.jsx)(C.A,{label:e.priority||"Medium",size:"small",sx:{bgcolor:"high"===e.priority?"#ef4444":"medium"===e.priority?"#f59e0b":"#3b82f6",color:"white",fontWeight:500}})}),(0,ge.jsx)(g.A,{children:(0,ge.jsxs)(c.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,ge.jsx)(I.A,{variant:"determinate",value:s,size:24,thickness:4,sx:{color:s>=100?"#10b981":"#3b82f6"}}),(0,ge.jsxs)(x.A,{variant:"body2",children:[s,"%"]})]})}),(0,ge.jsx)(g.A,{children:(0,ge.jsxs)(x.A,{variant:"body2",color:"text.secondary",children:[e.startDate?new Date(e.startDate).toLocaleDateString():"Not set"," - ",e.dueDate?new Date(e.dueDate).toLocaleDateString():"Not set"]})}),(0,ge.jsxs)(g.A,{align:"right",children:[(0,ge.jsx)(k.A,{size:"small",onClick:()=>ps(e),children:(0,ge.jsx)(Z.A,{fontSize:"small"})}),(0,ge.jsx)(k.A,{size:"small",onClick:()=>ks(e),children:(0,ge.jsx)(V.A,{fontSize:"small"})}),(0,ge.jsx)(k.A,{size:"small",onClick:()=>Ss(e._id),children:(0,ge.jsx)(U.A,{fontSize:"small"})})]})]},e._id)}))})]})}):(0,ge.jsx)(c.A,{sx:{p:2,textAlign:"center"},children:(0,ge.jsx)(x.A,{variant:"body1",color:"textSecondary",children:"No epics found"})}),ys=async(e,s)=>{try{const t=ue.find((s=>s._id===e));if(!t)return;const r=ue.map((t=>t._id===e?(0,i.A)((0,i.A)({},t),{},{status:s}):t));pe(r),await ne.A.updateEpicStatus(e,(0,i.A)((0,i.A)({},t),{},{status:s}))}catch(Ie){console.error("Error updating epic status:",Ie);const t=ue.map((s=>s._id===e?(0,i.A)((0,i.A)({},s),{},{status:s.status}):s));pe(t)}},vs=()=>{Xe(!1)},Cs=()=>{is(!1),ss(null)},ks=e=>{as(e),os(!0)},ws=()=>{os(!1),as(null)},Ss=async e=>{if(window.confirm("Are you sure you want to delete this epic?"))try{await ne.A.delete(e);const s=ue.filter((s=>s._id!==e));pe(s);const t={"to do":s.filter((e=>e.status===ds)),"in progress":s.filter((e=>e.status===xs)),done:s.filter((e=>e.status===hs))};$e(t)}catch(Ie){console.error("Error deleting epic:",Ie)}},Ds=(e,s)=>{as((t=>(0,i.A)((0,i.A)({},t),{},{[e]:s})))},Is=e=>{ze("sprints"),Pe(e)},Es=async(e,s)=>{try{console.log("Updating item:",e,"with status:",s);const t=be.find((s=>s._id===e));if(!t)return void console.error("Item not found:",e);console.log("Found item to update:",t);const r={title:t.title,description:t.description,type:t.type||"story",status:s,effortEstimate:t.effortEstimate||0,project:t.project,sprint:t.sprint,assignedTo:t.assignedTo};console.log("Sending update with data:",r),await de.A.update(t._id,r),ye((t=>t.map((t=>t._id===e?(0,i.A)((0,i.A)({},t),{},{status:s}):t))))}catch(Ie){console.error("Error updating backlog item status:",Ie),Ee("Failed to update status. Error: "+Ie.message)}};(0,r.useEffect)((()=>{"backlogItems"===We&&null!==s&&void 0!==s&&s._id&&(async()=>{try{const e=await de.A.getAll();console.log("Raw backlog items response:",e.data);const t=e.data.filter((e=>e.project===s._id));console.log("Current project:",s),console.log("Filtered backlog items:",t),ye(t)}catch(Ie){console.error("Error fetching backlog items:",Ie),Ee(Ie.message)}})()}),[We,null===s||void 0===s?void 0:s._id]);const Ws=e=>{},zs=e=>{},Bs=async()=>{const e=await Promise.all(ve.map((async e=>{const s=await(async e=>{try{const s=(await de.A.getAll()).data.filter((s=>s.sprint===e));if(0===s.length)return 0;const t=s.filter((e=>e.status===hs)).length/s.length*100;return Math.round(t)}catch(Ie){return console.error("Error calculating sprint progress:",Ie),0}})(e._id);return(0,i.A)((0,i.A)({},e),{},{progress:s})})));Ce(e)};(0,r.useEffect)((()=>{"sprints"===We&&Bs()}),[We]),(0,r.useEffect)((()=>{be.length>0&&Bs()}),[be]);return Se?(0,ge.jsx)(c.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:(0,ge.jsx)(I.A,{})}):Ie?(0,ge.jsx)(c.A,{sx:{p:3},children:(0,ge.jsx)(R.A,{severity:"error",children:Ie})}):s?(0,ge.jsx)(a.Q,{backend:n.t2,children:(0,ge.jsxs)(c.A,{sx:{display:"flex",flexDirection:"column",minHeight:"100vh",backgroundColor:"#f8fafc"},children:[(0,ge.jsx)(H.A,{position:"fixed",sx:{zIndex:e=>e.zIndex.drawer+1,backgroundColor:"#1e40af"},children:(0,ge.jsxs)(O.A,{sx:{minHeight:"64px !important"},children:[(0,ge.jsx)(k.A,{size:"large",edge:"start",color:"inherit","aria-label":"menu",sx:{mr:2},children:(0,ge.jsx)(G.A,{})}),(()=>{const e=[{name:"Home",icon:(0,ge.jsx)(J.A,{sx:{mr:.5},fontSize:"inherit"}),path:"/"},{name:"Projects",icon:(0,ge.jsx)(ie.A,{sx:{mr:.5},fontSize:"inherit"}),path:"/projects"},{name:(null===s||void 0===s?void 0:s.name)||"Project Details",icon:(0,ge.jsx)(X.A,{sx:{mr:.5},fontSize:"inherit"})}];return"backlog"===We?e.push({name:"Backlog",icon:(0,ge.jsx)(se.A,{sx:{mr:.5},fontSize:"inherit"})}):"epics"===We?e.push({name:"Epics",icon:(0,ge.jsx)(X.A,{sx:{mr:.5},fontSize:"inherit"})}):"sprints"===We&&e.push({name:"Sprints",icon:(0,ge.jsx)(te.A,{sx:{mr:.5},fontSize:"inherit"})}),(0,ge.jsx)(E.A,{separator:(0,ge.jsx)($.A,{fontSize:"small",sx:{color:"rgba(255,255,255,0.7)"}}),sx:{flex:1,"& .MuiBreadcrumbs-li":{display:"flex",alignItems:"center"}},children:e.map(((s,t)=>t===e.length-1?(0,ge.jsxs)(x.A,{sx:{display:"flex",alignItems:"center",color:"rgba(255,255,255,0.7)",fontWeight:"medium"},children:[s.icon,s.name]},s.name):(0,ge.jsxs)(W.A,{component:l.N_,to:s.path,sx:{display:"flex",alignItems:"center",color:"#fff",textDecoration:"none","&:hover":{textDecoration:"underline",color:"#fff"}},children:[s.icon,s.name]},s.name)))})})(),(0,ge.jsx)(k.A,{color:"inherit",children:(0,ge.jsx)(Q.A,{})})]})}),(0,ge.jsxs)(c.A,{sx:{display:"flex",pt:"64px"},children:[(0,ge.jsx)(c.A,{component:"nav",sx:{width:240,flexShrink:0},children:(()=>{const e="scrum"===Ue?[{id:"backlog",icon:(0,ge.jsx)(se.A,{}),label:"Backlog"},{id:"backlogItems",icon:(0,ge.jsx)(K.A,{}),label:"Backlog Items"},{id:"sprints",icon:(0,ge.jsx)(te.A,{}),label:"Sprints"}]:[{id:"epics",icon:(0,ge.jsx)(X.A,{}),label:"Epics"},{id:"issues",icon:(0,ge.jsx)(te.A,{}),label:"Issues"}];return(0,ge.jsxs)(c.A,{sx:{width:"240px",backgroundColor:"#fff",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",display:"flex",flexDirection:"column",height:"100vh",position:"fixed",left:0,top:64,color:"#1e40af",zIndex:100,transition:"all 0.3s ease"},children:[(0,ge.jsxs)(c.A,{sx:{display:"flex",alignItems:"center",px:3,py:3,borderBottom:"1px solid rgba(0, 0, 0, 0.06)",mb:1,background:"linear-gradient(to right, rgba(30, 64, 175, 0.05), transparent)"},children:[(0,ge.jsx)(d.A,{sx:{bgcolor:"#1e40af",width:40,height:40,fontSize:"1.2rem",fontWeight:600,mr:2,boxShadow:"0 2px 4px rgba(0,0,0,0.1)",border:"2px solid #fff"},children:Ge}),(0,ge.jsx)(x.A,{variant:"h6",sx:{fontWeight:600,color:"#1e293b",fontSize:"1.1rem"},children:null===s||void 0===s?void 0:s.name})]}),(0,ge.jsx)(c.A,{sx:{flex:1,py:2},children:e.map((e=>(0,ge.jsx)(h.A,{startIcon:e.icon,onClick:()=>us(e.id),sx:{justifyContent:"flex-start",px:3,py:1.5,width:"100%",color:We===e.id?"#fff":"#64748b",backgroundColor:We===e.id?"#1e40af":"transparent",borderRadius:0,position:"relative",transition:"all 0.2s ease","&:hover":{backgroundColor:We===e.id?"#1e40af":"rgba(30, 64, 175, 0.08)",color:We===e.id?"#fff":"#1e40af","&::before":{width:"4px"}},"&::before":{content:'""',position:"absolute",left:0,top:0,width:We===e.id?"4px":"0px",height:"100%",backgroundColor:"#1e40af",transition:"width 0.2s ease"},textTransform:"capitalize",letterSpacing:"0.5px",fontSize:"0.95rem",fontWeight:We===e.id?600:500},children:e.label},e.id)))})]})})()}),(0,ge.jsx)(c.A,{component:"main",sx:{flexGrow:1,p:3,width:"100%"},children:(0,ge.jsxs)(f.A,{sx:{p:3,borderRadius:2,backgroundColor:"#fff",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.05)"},children:[(()=>{if(Se)return(0,ge.jsx)(I.A,{});if(Ie)return(0,ge.jsx)(R.A,{severity:"error",children:Ie});switch(We){case"epics":return ue&&0!==ue.length?(0,ge.jsxs)(c.A,{children:[(0,ge.jsx)(c.A,{sx:{mb:2},children:(0,ge.jsx)(h.A,{variant:"contained",startIcon:(0,ge.jsx)(se.A,{}),onClick:()=>Ze("cards"===Ye?"table":"cards"),sx:{mr:1},children:"cards"===Ye?"Table View":"Card View"})}),"cards"===Ye?(0,ge.jsx)(a.Q,{backend:n.t2,children:ms()}):bs()]}):(0,ge.jsx)(c.A,{sx:{p:2,textAlign:"center"},children:(0,ge.jsx)(x.A,{variant:"body1",color:"text.secondary",children:"No epics found"})});case"backlog":return fs();case"sprints":return(0,ge.jsxs)(c.A,{sx:{p:3},children:[(0,ge.jsx)(x.A,{variant:"h5",sx:{mb:3},children:"Sprints"}),(0,ge.jsx)(_.Ay,{container:!0,spacing:3,children:ve.map((e=>(0,ge.jsx)(_.Ay,{item:!0,xs:12,md:6,lg:4,children:(0,ge.jsxs)(w.A,{sx:{height:"100%",display:"flex",flexDirection:"column",position:"relative"},children:[(0,ge.jsxs)(S.A,{sx:{flexGrow:1},children:[(0,ge.jsx)(x.A,{variant:"h6",gutterBottom:!0,children:e.name}),(0,ge.jsxs)(c.A,{sx:{mb:2},children:[(0,ge.jsx)(x.A,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Progress"}),(0,ge.jsxs)(c.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,ge.jsx)(c.A,{sx:{flexGrow:1},children:(0,ge.jsx)(M.A,{variant:"determinate",value:e.progress||0,sx:{height:8,borderRadius:4,backgroundColor:"#e2e8f0","& .MuiLinearProgress-bar":{backgroundColor:100===e.progress?"#059669":e.progress>=70?"#3b82f6":e.progress>=30?"#f59e0b":"#ef4444",borderRadius:4}}})}),(0,ge.jsxs)(x.A,{variant:"body2",sx:{minWidth:40,color:100===e.progress?"#059669":e.progress>=70?"#3b82f6":e.progress>=30?"#f59e0b":"#ef4444"},children:[e.progress||0,"%"]})]})]}),(0,ge.jsxs)(x.A,{variant:"body2",color:"text.secondary",children:["Start Date: ",new Date(e.startDate).toLocaleDateString()]}),(0,ge.jsxs)(x.A,{variant:"body2",color:"text.secondary",children:["End Date: ",new Date(e.endDate).toLocaleDateString()]})]}),(0,ge.jsx)(D.A,{children:(0,ge.jsx)(h.A,{size:"small",startIcon:(0,ge.jsx)(Z.A,{}),onClick:()=>Is(e),children:"View Details"})})]})},e._id)))})]});case"backlogItems":return(0,ge.jsxs)(c.A,{sx:{p:3},children:[(0,ge.jsx)(x.A,{variant:"h5",sx:{mb:3},children:"Backlog Items"}),0===be.length?(0,ge.jsx)(R.A,{severity:"info",children:"No backlog items found for this project"}):(0,ge.jsx)(m.A,{component:f.A,children:(0,ge.jsxs)(u.A,{children:[(0,ge.jsx)(p.A,{children:(0,ge.jsxs)(A.A,{children:[(0,ge.jsx)(g.A,{children:"Title"}),(0,ge.jsx)(g.A,{children:"Description"}),(0,ge.jsx)(g.A,{children:"Type"}),(0,ge.jsx)(g.A,{children:"Status"}),(0,ge.jsx)(g.A,{children:"Effort"}),(0,ge.jsx)(g.A,{children:"Actions"})]})}),(0,ge.jsx)(j.A,{children:be.map((e=>(0,ge.jsxs)(A.A,{children:[(0,ge.jsx)(g.A,{children:e.title}),(0,ge.jsx)(g.A,{children:e.description}),(0,ge.jsx)(g.A,{children:(0,ge.jsx)(C.A,{label:e.type,size:"small",color:"bug"===e.type?"error":"story"===e.type?"primary":"default"})}),(0,ge.jsx)(g.A,{children:(0,ge.jsx)(b.A,{size:"small",children:(0,ge.jsxs)(y.A,{value:e.status||ds,onChange:s=>Es(e._id,s.target.value),sx:{minWidth:120,"& .MuiSelect-select":{py:1,bgcolor:e.status===hs?"#dcfce7":e.status===xs?"#dbeafe":"#f1f5f9",color:e.status===hs?"#059669":e.status===xs?"#2563eb":"#475569"}},children:[(0,ge.jsx)(v.A,{value:ds,children:"To Do"}),(0,ge.jsx)(v.A,{value:xs,children:"In Progress"}),(0,ge.jsx)(v.A,{value:hs,children:"Done"})]})})}),(0,ge.jsx)(g.A,{children:e.effortEstimate}),(0,ge.jsxs)(g.A,{children:[(0,ge.jsx)(k.A,{size:"small",onClick:()=>Ws(e),children:(0,ge.jsx)(V.A,{})}),(0,ge.jsx)(k.A,{size:"small",onClick:()=>zs(e._id),children:(0,ge.jsx)(U.A,{})})]})]},e._id)))})]})})]});case"issues":return(0,ge.jsx)(c.A,{sx:{p:3},children:(0,ge.jsx)(fe.default,{projectId:s.id})});default:return null}})(),(0,ge.jsx)(xe.default,{open:Ke,onClose:vs,projectId:e,onEpicAdded:async()=>{try{const s=await ne.A.getByProject(e);pe(s.data),vs()}catch(Ie){console.error("Error fetching epics:",Ie)}}}),(()=>{if(!es)return null;const e=js(es.progress);return(0,ge.jsxs)(z.A,{open:ts,onClose:Cs,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:2,boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)"}},children:[(0,ge.jsx)(B.A,{sx:{bgcolor:"#f8fafc",borderBottom:"1px solid #e2e8f0",px:3,py:2},children:(0,ge.jsxs)(c.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,ge.jsxs)(c.A,{children:[(0,ge.jsx)(x.A,{variant:"h5",sx:{color:"#1e293b",fontWeight:600,mb:1},children:es.name}),(0,ge.jsxs)(c.A,{sx:{display:"flex",gap:1},children:[(0,ge.jsx)(C.A,{label:es.status||"To Do",size:"small",sx:{bgcolor:"done"===es.status?"#10b981":"in progress"===es.status?"#3b82f6":"#e2e8f0",color:"to do"===es.status?"#1e293b":"white",fontWeight:500}}),(0,ge.jsx)(C.A,{label:es.priority||"Medium",size:"small",sx:{bgcolor:"high"===es.priority?"#ef4444":"medium"===es.priority?"#f59e0b":"#3b82f6",color:"white",fontWeight:500}})]})]}),(0,ge.jsx)(k.A,{edge:"end",color:"inherit",onClick:Cs,"aria-label":"close",sx:{color:"#64748b"},children:(0,ge.jsx)(re.A,{})})]})}),(0,ge.jsx)(P.A,{sx:{px:3,py:3},children:(0,ge.jsxs)(_.Ay,{container:!0,spacing:3,children:[(0,ge.jsxs)(_.Ay,{item:!0,xs:12,md:8,children:[(0,ge.jsxs)(c.A,{sx:{mb:4},children:[(0,ge.jsxs)(x.A,{variant:"h6",gutterBottom:!0,sx:{color:"#1e293b",fontWeight:600,display:"flex",alignItems:"center",gap:1},children:[(0,ge.jsx)(X.A,{sx:{color:"#3b82f6"}}),"Description"]}),(0,ge.jsx)(f.A,{sx:{p:2,bgcolor:"#f8fafc",borderRadius:2,minHeight:100},children:(0,ge.jsx)(x.A,{variant:"body1",sx:{color:"#475569",whiteSpace:"pre-wrap"},children:es.description||"No description provided"})})]}),(0,ge.jsxs)(c.A,{children:[(0,ge.jsxs)(x.A,{variant:"h6",gutterBottom:!0,sx:{color:"#1e293b",fontWeight:600,display:"flex",alignItems:"center",gap:1},children:[(0,ge.jsx)(te.A,{sx:{color:"#3b82f6"}}),"Related Issues"]}),(0,ge.jsx)(f.A,{sx:{p:2,bgcolor:"#f8fafc",borderRadius:2},children:es.issues&&es.issues.length>0?(0,ge.jsx)(T.A,{disablePadding:!0,children:es.issues.map(((e,s)=>(0,ge.jsx)(F.Ay,{disablePadding:!0,sx:{py:1,borderBottom:s<es.issues.length-1?"1px solid #e2e8f0":"none"},children:(0,ge.jsx)(N.A,{primary:e.title,secondary:e.status,primaryTypographyProps:{sx:{color:"#1e293b"}},secondaryTypographyProps:{sx:{color:"#64748b"}}})},e._id||s)))}):(0,ge.jsx)(x.A,{variant:"body2",sx:{color:"#64748b"},children:"No issues linked to this epic"})})]})]}),(0,ge.jsxs)(_.Ay,{item:!0,xs:12,md:4,children:[(0,ge.jsxs)(c.A,{sx:{mb:4},children:[(0,ge.jsxs)(x.A,{variant:"h6",gutterBottom:!0,sx:{color:"#1e293b",fontWeight:600,display:"flex",alignItems:"center",gap:1},children:[(0,ge.jsx)(Y.A,{sx:{color:"#3b82f6"}}),"Progress"]}),(0,ge.jsx)(f.A,{sx:{p:3,bgcolor:"#f8fafc",borderRadius:2,textAlign:"center"},children:(0,ge.jsxs)(c.A,{sx:{position:"relative",display:"inline-flex"},children:[(0,ge.jsx)(I.A,{variant:"determinate",value:e,size:80,thickness:4,sx:{color:e>=100?"#10b981":"#3b82f6"}}),(0,ge.jsx)(c.A,{sx:{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,ge.jsxs)(x.A,{variant:"h6",sx:{color:"#1e293b",fontWeight:600},children:[e,"%"]})})]})})]}),(0,ge.jsxs)(c.A,{sx:{mb:4},children:[(0,ge.jsxs)(x.A,{variant:"h6",gutterBottom:!0,sx:{color:"#1e293b",fontWeight:600,display:"flex",alignItems:"center",gap:1},children:[(0,ge.jsx)(oe.A,{sx:{color:"#3b82f6"}}),"Timeline"]}),(0,ge.jsx)(f.A,{sx:{p:2,bgcolor:"#f8fafc",borderRadius:2},children:(0,ge.jsxs)(_.Ay,{container:!0,spacing:2,children:[(0,ge.jsxs)(_.Ay,{item:!0,xs:6,children:[(0,ge.jsx)(x.A,{variant:"subtitle2",sx:{color:"#64748b",mb:.5},children:"Start Date"}),(0,ge.jsx)(x.A,{variant:"body1",sx:{color:"#1e293b",fontWeight:500},children:es.startDate?new Date(es.startDate).toLocaleDateString():"Not set"})]}),(0,ge.jsxs)(_.Ay,{item:!0,xs:6,children:[(0,ge.jsx)(x.A,{variant:"subtitle2",sx:{color:"#64748b",mb:.5},children:"Due Date"}),(0,ge.jsx)(x.A,{variant:"body1",sx:{color:"#1e293b",fontWeight:500},children:es.dueDate?new Date(es.dueDate).toLocaleDateString():"Not set"})]})]})})]}),(0,ge.jsxs)(c.A,{children:[(0,ge.jsxs)(x.A,{variant:"h6",gutterBottom:!0,sx:{color:"#1e293b",fontWeight:600,display:"flex",alignItems:"center",gap:1},children:[(0,ge.jsx)(ee.A,{sx:{color:"#3b82f6"}}),"Team"]}),(0,ge.jsx)(f.A,{sx:{p:2,bgcolor:"#f8fafc",borderRadius:2},children:es.assignees&&es.assignees.length>0?(0,ge.jsx)(c.A,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:es.assignees.map(((e,s)=>(0,ge.jsx)(C.A,{avatar:(0,ge.jsx)(d.A,{children:e.name[0]}),label:e.name,sx:{bgcolor:"#e2e8f0",color:"#1e293b"}},e._id||s)))}):(0,ge.jsx)(x.A,{variant:"body2",sx:{color:"#64748b"},children:"No team members assigned"})})]})]})]})}),(0,ge.jsxs)(L.A,{sx:{px:3,py:2,bgcolor:"#f8fafc",borderTop:"1px solid #e2e8f0"},children:[(0,ge.jsx)(h.A,{onClick:Cs,sx:{color:"#64748b","&:hover":{bgcolor:"#f1f5f9"}},children:"Close"}),(0,ge.jsx)(h.A,{onClick:()=>ks(es),variant:"contained",startIcon:(0,ge.jsx)(V.A,{}),sx:{bgcolor:"#1e40af","&:hover":{bgcolor:"#1e3a8a"}},children:"Edit Epic"})]})]})})(),(0,ge.jsxs)(z.A,{open:rs,onClose:ws,maxWidth:"sm",fullWidth:!0,children:[(0,ge.jsx)(B.A,{children:(0,ge.jsxs)(c.A,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[(0,ge.jsx)(x.A,{variant:"h6",children:"Edit Epic"}),(0,ge.jsx)(k.A,{edge:"end",color:"inherit",onClick:ws,"aria-label":"close",children:(0,ge.jsx)(re.A,{})})]})}),(0,ge.jsx)(P.A,{children:(0,ge.jsxs)(c.A,{sx:{mt:2},children:[(0,ge.jsx)(q.A,{fullWidth:!0,label:"Name",value:(null===ls||void 0===ls?void 0:ls.name)||"",onChange:e=>Ds("name",e.target.value),sx:{mb:2}}),(0,ge.jsx)(q.A,{fullWidth:!0,label:"Description",value:(null===ls||void 0===ls?void 0:ls.description)||"",onChange:e=>Ds("description",e.target.value),multiline:!0,rows:4,sx:{mb:2}}),(0,ge.jsx)(b.A,{fullWidth:!0,sx:{mb:2},children:(0,ge.jsxs)(y.A,{value:(null===ls||void 0===ls?void 0:ls.status)||ds,onChange:e=>Ds("status",e.target.value),displayEmpty:!0,children:[(0,ge.jsx)(v.A,{value:ds,children:"To Do"}),(0,ge.jsx)(v.A,{value:xs,children:"In Progress"}),(0,ge.jsx)(v.A,{value:hs,children:"Done"})]})}),(0,ge.jsx)(b.A,{fullWidth:!0,sx:{mb:2},children:(0,ge.jsxs)(y.A,{value:(null===ls||void 0===ls?void 0:ls.priority)||"medium",onChange:e=>Ds("priority",e.target.value),displayEmpty:!0,children:[(0,ge.jsx)(v.A,{value:"low",children:"Low"}),(0,ge.jsx)(v.A,{value:"medium",children:"Medium"}),(0,ge.jsx)(v.A,{value:"high",children:"High"})]})})]})}),(0,ge.jsxs)(L.A,{children:[(0,ge.jsx)(h.A,{onClick:ws,children:"Cancel"}),(0,ge.jsx)(h.A,{onClick:async()=>{try{await ne.A.update(ls._id,ls);const e=ue.map((e=>e._id===ls._id?ls:e));pe(e);const s={"to do":e.filter((e=>e.status===ds)),"in progress":e.filter((e=>e.status===xs)),done:e.filter((e=>e.status===hs))};$e(s),ws()}catch(Ie){console.error("Error updating epic:",Ie)}},variant:"contained",sx:{bgcolor:"#1e40af","&:hover":{bgcolor:"#1e3a8a"}},children:"Save Changes"})]})]}),(0,ge.jsx)(z.A,{open:Fe,onClose:()=>Ne(!1),maxWidth:"sm",fullWidth:!0,children:(0,ge.jsx)(he.default,{open:Fe,onClose:()=>Ne(!1),onBacklogCreated:async()=>{try{const s=await ce.A.getByProject(e);je(s.data),Ne(!1)}catch(s){Ee("Failed to refresh backlogs. Please try again.")}}})}),(0,ge.jsxs)(z.A,{open:Le,onClose:()=>Re(!1),maxWidth:"sm",fullWidth:!0,children:[(0,ge.jsx)(B.A,{children:"Edit Backlog"}),(0,ge.jsx)(P.A,{children:(0,ge.jsx)(q.A,{label:"Backlog Name",value:Me,onChange:e=>He(e.target.value),fullWidth:!0,margin:"normal"})}),(0,ge.jsxs)(L.A,{children:[(0,ge.jsx)(h.A,{onClick:()=>Re(!1),children:"Cancel"}),(0,ge.jsx)(h.A,{onClick:async()=>{try{await ce.A.update(selectedBacklog._id,{name:Me}),Re(!1);const s=await ce.A.getByProject(e);je(s.data)}catch(s){Ee("Failed to update backlog. Please try again.")}},variant:"contained",color:"primary",children:"Save"})]})]})]})})]})]})}):(0,ge.jsx)(c.A,{sx:{p:2},children:"Project not found"})}},40293:(e,s,t)=>{t.d(s,{A:()=>r});var i=t(50214);const r={getAll:()=>i.A.get("/BacklogItems"),create:e=>i.A.post("/BacklogItems",e),deleteBacklogItems:e=>i.A.delete("/BacklogItems/".concat(e)),getBacklogItems:e=>i.A.get("/BacklogItems/id/".concat(e)),update:(e,s)=>i.A.put("/BacklogItems/".concat(e),s),findByUser:e=>i.A.get("/BacklogItems/user/".concat(e))}},28016:(e,s,t)=>{t.d(s,{A:()=>r});var i=t(50214);const r={getAll:()=>i.A.get("/Backlogs"),getById:e=>i.A.get("/Backlogs/id/".concat(e)),getByProject:e=>i.A.get("/Backlogs/projectId/".concat(e)),create:e=>i.A.post("/Backlogs",e),update:(e,s)=>i.A.put("/Backlogs/".concat(e),s),remove:e=>i.A.delete("/Backlogs/".concat(e)),findByUser:e=>i.A.get("/Backlogs/user/".concat(e))}},98008:(e,s,t)=>{t.d(s,{A:()=>o});var i=t(50214);const r=e=>{var s,t,i;const r={name:null===(s=e.name)||void 0===s?void 0:s.trim(),description:null===(t=e.description)||void 0===t?void 0:t.trim(),status:(null===(i=e.status)||void 0===i?void 0:i.toLowerCase())||"to do",priority:(e.priority||"medium").toLowerCase(),startDate:e.startDate||void 0,dueDate:e.dueDate||void 0,owner:e.owner||localStorage.getItem("userId"),watchers:e.watchers||[]};return void 0!==e.project&&(r.project=e.project||null),Object.keys(r).forEach((e=>{void 0===r[e]&&delete r[e]})),console.log("Original epic data:",e),console.log("Transformed epic data:",r),r},o={getAll:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return i.A.get("/epics",{params:e})},getById:e=>i.A.get("/epics/".concat(e)),getByProject:e=>i.A.get("/epics/project/".concat(e)),create:e=>{const s=r(e);return i.A.post("/epics",s)},update:(e,s)=>{const t=r(s);return console.log("Transformed update data:",t),i.A.put("/epics/".concat(e),t)},remove:e=>i.A.delete("/epics/".concat(e)),updateProgress:e=>i.A.post("/epics/".concat(e,"/progress")),addWatcher:(e,s)=>i.A.post("/epics/".concat(e,"/watchers"),{userId:s}),removeWatcher:(e,s)=>i.A.delete("/epics/".concat(e,"/watchers"),{data:{userId:s}}),updateEpicStatus:(e,s)=>{const t=r(s);return i.A.put("/epics/".concat(e),t)}}},54859:(e,s,t)=>{t.d(s,{A:()=>r});var i=t(50214);const r={getAll:()=>i.A.get("/sprints"),getSprint:e=>i.A.get("/sprints/id/".concat(e)),create:e=>i.A.post("/sprints",e),update:(e,s)=>i.A.put("/sprints/".concat(e),s),deleteSprint:e=>i.A.delete("/sprints/".concat(e)),updateBacklogItems:(e,s)=>(console.log("Sending backlogItemId:",s),i.A.put("/sprints/".concat(e,"/backlogItems"),{backlogItemId:s})),getByProject:e=>(console.log("Fetching sprints for project:",e),i.A.get("/sprints/project/".concat(e)))}}}]);
//# sourceMappingURL=522.77bcc57a.chunk.js.map